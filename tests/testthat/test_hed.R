test_that("Test HLA Evolutionary Divergence (HED) class I", {

  df <- tribble(~allele1, ~allele2, ~hed,
                'A*01:01','A*03:01',5.745856353591161,
                'B*07:39','B*07:04',0.8839779005524862,
                'C*01:02','C*01:80',0.5414364640883977,
                'A*03:70','A*03:99',1.143646408839779,
                'B*07:31','B*08:52',6.928176795580111,
                'C*01:64','C*02:20',5.558011049723757,
                'A*11:14','A*01:14',4.685082872928176,
                'B*44:28','B*44:95',1.022099447513812,
                'C*03:27','C*03:91',2.138121546961326,
                'A*24:19','A*68:86',7.535911602209945,
                'B*54:06','B*81:05',7.43646408839779,
                'C*03:75','C*04:41',7.933701657458563
                )


    for (i in 1:nrow(df)){
        expect_equal(
            cHED(df$allele1[i],df$allele2[i]),
            df$hed[i]
        )
    }

  expect_error(
    cHED('A*01:01x','A*03:01x')
  )
})

test_that("Test HLA Evolutionary Divergence (HED) class II", {

  df <- tribble(~allele1, ~allele2, ~hed,
                'DRB10701',	'DRB11302',	17.168539325842698,
                'DRB11104','DRB11501',10.764044943820224,
                'DRB10803','DRB11602',10.348314606741573,
                'DRB10701','DRB11404',15.561797752808989,
                'DRB11104','DRB11454',7.50561797752809,
                'DRB10101','DRB11301',14.50561797752809,
                'DRB10803','DRB11301',7.98876404494382,
                'DQB10501','DQB10603',7.101123595505618,
                'DQB10301','DQB10603',10.741573033707866
                )


  for (i in 1:nrow(df)){
    expect_equal(
      cHED(hla1 = df$allele1[i],hla2 = df$allele2[i]),
      df$hed[i]
    )
  }

  expect_error(
    cHED('DRB1*01:01x','DRB1*03:01x')
  )

  df2 <- tribble(~allele1, ~allele2, ~hed,
                'DRB1*07:01',	'DRB1*13:02',	17.168539325842698,
                'DRB1*11:04','DRB1*15:01',10.764044943820224,
                'DRB1*08:03','DRB1*16:02',10.348314606741573,
                'DRB1*07:01','DRB1*14:04',15.561797752808989,
                'DRB1*11:04','DRB1*14:54',7.50561797752809,
                'DRB1*01:01','DRB1*13:01',14.50561797752809,
                'DRB1*08:03','DRB1*13:01',7.98876404494382,
                'DQB1*05:01','DQB1*06:03',7.101123595505618,
                'DQB1*03:01','DQB1*06:03',10.741573033707866
  )


  for (i in 1:nrow(df)){
    expect_equal(
      cHED(hla1 = df$allele1[i],hla2 = df$allele2[i]),
      df$hed[i]
    )
  }
})
