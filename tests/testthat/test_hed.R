test_that("Test HLA Evolutionary Divergence (HED)", {

  df <- tribble(~allele1, ~allele2, ~hed,
                'A*01:01','A*03:01',5.745856353591161,
                'B*07:39','B*07:04',0.8839779005524862,
                'C*01:02','C*01:80',0.5414364640883977,
                'A*03:70','A*03:99',1.143646408839779,
                'B*07:31','B*08:52',6.928176795580111,
                'C*01:64','C*02:20',5.558011049723757,
                'A*11:14','A*01:14',4.685082872928176,
                'B*44:28','B*44:95',1.022099447513812,
                'C*03:27','C*03:91',2.138121546961326,
                'A*24:19','A*68:86',7.535911602209945,
                'B*54:06','B*81:05',7.43646408839779,
                'C*03:75','C*04:41',7.933701657458563
                )


    for (i in 1:nrow(df)){
        expect_equal(
            cHED(df$allele1[i],df$allele2[i]),
            df$hed[i]
        )
    }

  expect_error(
    cHED('A*01:01x','A*03:01x')
  )
})
